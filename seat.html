

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Seat Booking</title>
<style>
body{font-family:Arial;background:#f5f6f8}
.header{text-align:center;padding:15px;background:#fff;font-weight:bold}
.tabs{display:flex;justify-content:center;gap:10px;margin-top:10px}
.tab{padding:10px 20px;background:#ddd;cursor:pointer}
.tab.active{background:#ffc107}
.grid{
  max-width:700px;margin:20px auto;
  display:grid;grid-template-columns:repeat(6,1fr);gap:10px
}
.seat{padding:14px;text-align:center;background:#eee;cursor:pointer}
.booked{background:#e57373;color:#fff;cursor:not-allowed}
.selected{background:#66bb6a;color:#fff}
button{
  display:block;margin:20px auto;padding:12px 30px;
  background:#ffc107;border:none;font-weight:bold
}
</style>
</head>

<body>

<div class="header" id="head"></div>

<div class="tabs">
  <div class="tab active" onclick="showDeck('lower',this)">LOWER</div>
  <div class="tab" onclick="showDeck('upper',this)">UPPER</div>
</div>

<div class="grid" id="lower"></div>
<div class="grid" id="upper" style="display:none"></div>

<button onclick="confirm()">Confirm Booking</button>

<script>
const TOTAL_PER_DECK = 18;

const name=localStorage.getItem("busName");
const route=localStorage.getItem("route");
const price=localStorage.getItem("price");
const date=localStorage.getItem("busDate");

const key=()=>`${name}|${route}|${date}`;

head.innerText=`${name} | ${route} | ${date} | ₹${price}`;

let booked=JSON.parse(localStorage.getItem(key()))||[];
let selected=[];

function draw(deck,start){
  deck.innerHTML="";
  for(let i=0;i<TOTAL_PER_DECK;i++){
    const num=start+i;
    const s=document.createElement("div");
    s.innerText=num;
    s.className="seat";

    if(booked.includes(num)) s.classList.add("booked");

    s.onclick=()=>{
      if(s.classList.contains("booked"))return;
      s.classList.toggle("selected");
      selected.includes(num)
        ? selected=selected.filter(x=>x!==num)
        : selected.push(num);
    };
    deck.appendChild(s);
  }
}

draw(lower,1);      // Lower: 1–18
draw(upper,19);    // Upper: 19–36

function showDeck(id,btn){
  lower.style.display=id==="lower"?"grid":"none";
  upper.style.display=id==="upper"?"grid":"none";
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  btn.classList.add("active");
}

function confirm(){
  if(selected.length===0){alert("Select seat");return;}
  booked=booked.concat(selected);
  localStorage.setItem(key(),JSON.stringify(booked));
  alert("Booking Successful");
  location.href="search.html";
}
</script>

</body>
</html>
